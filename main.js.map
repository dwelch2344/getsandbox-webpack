{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/util.js","webpack:///./src/base.js","webpack:///./src/identity.js","webpack:///./src/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","strip","data","Array","map","_","omit","_util","Base","state","STATE_PROP","_this","this","resource","arguments","length","undefined","_classCallCheck","nextId","generatedId","col","getId","obj","id","setId","findById","find","e","findByIndex","findIndex","persist","idx","push","req","res","json","getOne","params","match","errors","title","detail","put","updated","body","patch","result","extend","post","delete","message","Sandbox","define","_base","Identities","_possibleConstructorReturn","__proto__","getPrototypeOf","getSponsor","test","_get","_identity","keys","config","_identity2","default","configureSandbox"],"mappings":"aACA,IAAAA,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,IACAG,EAAAH,EACAI,GAAA,EACAH,YAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAZ,EAAAmB,EAAA,SAAAjB,GACAY,OAAAC,eAAAb,EAAA,cAAiDkB,OAAA,KAIjDpB,EAAAqB,EAAA,SAAAlB,GACA,IAAAS,EAAAT,KAAAmB,WACA,WAA2B,OAAAnB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAU,EAAAC,GAAsD,OAAAV,OAAAW,UAAAC,eAAAnB,KAAAgB,EAAAC,IAGtDxB,EAAA2B,EAAA,GAIA3B,IAAA4B,EAAA,mFC/DaC,QAAQ,SAARA,EAASC,GACpB,OAAIA,aAAgBC,MACXD,EAAKE,IAAIH,GAETI,EAAEC,KAAKJ,EAAM,8UCRxBK,EAAAnC,EAAA,OAEqBoC,aAEnB,SAAAA,EAAYC,EAAOC,GAAsC,IAAAC,EAAAC,KAA1BC,EAA0BC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,OAAbJ,+FAAaO,CAAAL,KAAAJ,GAAAI,KAMzDM,OAAS,EANgDN,KAOzDO,YAAc,kBAAMD,UAPqCN,KASzDQ,IAAM,kBAAMT,EAAKA,EAAKD,aATmCE,KAWzDS,MAAQ,SAAAC,GAAA,OAAOA,EAAIC,IAXsCX,KAYzDY,MAAQ,SAACF,EAAKC,GAAN,OAAaD,EAAIC,GAAKA,GAZ2BX,KAazDa,SAAW,SAAAF,GAAA,OAAMlB,EAAEqB,KAAKf,EAAKS,MAAO,SAAAO,GAAA,OAAKhB,EAAKU,MAAMM,IAAMJ,KAbDX,KAczDgB,YAAc,SAAAL,GAAA,OAAMlB,EAAEwB,UAAUlB,EAAKS,MAAQ,SAAAO,GAAA,OAAKhB,EAAKU,MAAMM,IAAMJ,KAdVX,KAezDkB,QAAU,SAAAR,GACR,IAAIF,EAAMT,EAAKS,MACXW,EAAMpB,EAAKiB,YAAajB,EAAKU,MAAMC,IACnCS,GAAO,EACTX,EAAIW,GAAOT,EAEXF,EAAIY,KAAKV,IArB4CV,KAyBzDtB,IAAM,SAAC2C,EAAKC,GACV,IAAMhC,EAAOS,EAAKS,MAClB,OAAOc,EAAIC,MAAQjC,UA3BoCU,KA8BzDwB,OAAS,SAACH,EAAKC,GAAQ,IACbX,EAAOU,EAAII,OAAXd,GACFe,EAAQ3B,EAAKc,SAASF,GAC5B,OAAIe,EACKJ,EAAIC,MAAM,EAAA5B,EAAAN,OAAMqC,IAEhBJ,EAAIC,KAAK,KACdI,SAEQC,MAAS,qBACTC,OAAU,OAASlB,EAAK,wBAxCmBX,KA+CzD8B,IAAM,SAACT,EAAKC,GAAQ,IACVX,EAAOU,EAAII,OAAXd,GACFe,EAAQ3B,EAAKc,SAASF,GAC5B,GAAIe,EAAQ,CACV,IAAMK,EAAUV,EAAIW,KAGpB,OAFAjC,EAAKa,MAAMmB,EAAShC,EAAKU,MAAMiB,IAC/B3B,EAAKmB,QAAQa,GACNT,EAAIC,MAAM,EAAA5B,EAAAN,OAAM0C,IAEvB,OAAOT,EAAIC,KAAK,KACdI,SAEQC,MAAS,qBACTC,OAAU,OAASlB,EAAK,wBA5DmBX,KAmEzDiC,MAAQ,SAACZ,EAAKC,GAAQ,IACZX,EAAOU,EAAII,OAAXd,GACFe,EAAQ3B,EAAKc,SAASF,GAC5B,GAAIe,EAAQ,CACV,IAAMQ,EAASzC,EAAE0C,UAAWT,EAAOL,EAAIW,MAGvC,OAFAjC,EAAKa,MAAMsB,EAAQnC,EAAKU,MAAMiB,IAC9B3B,EAAKmB,QAAQgB,GACNZ,EAAIC,MAAM,EAAA5B,EAAAN,OAAM6C,IAEvB,OAAOZ,EAAIC,KAAK,KACdI,SAEQC,MAAS,qBACTC,OAAU,OAASlB,EAAK,wBAhFmBX,KAuFzDoC,KAAO,SAACf,EAAKC,GAAQ,IACXU,EAASX,EAATW,KAGR,OAFAA,EAAKrB,GAAKZ,EAAKQ,cACfR,EAAKmB,QAAQc,GACNV,EAAIC,KAAKS,IA3FuChC,KA8FzDqC,OAAS,SAAChB,EAAKC,GAAQ,IACbX,EAAOU,EAAII,OAAXd,GACFe,EAAQ3B,EAAKiB,YAAYL,GAC/B,OAAIe,GAAS,UACJ3B,EAAKS,MAAMkB,GACXJ,EAAIC,MAAOe,QAAS,QAEpBhB,EAAIC,KAAK,KACdI,SAEQC,MAAS,qBACTC,OAAA,YAAsB9B,EAAKD,WAA3B,KAA0Ca,EAA1C,uBAxGZX,KAAKF,WAAaA,EAClBE,KAAKF,GAAcD,EAAMC,GAAcD,EAAMC,OAC7CE,KAAKC,SAAWA,qDA6GDsC,GAAQ,IAChBtC,EAAYD,KAAZC,SACPsC,EAAQC,OAAOvC,EAAU,MAAOD,KAAKtB,KACrC6D,EAAQC,OAAOvC,EAAU,OAAQD,KAAKoC,MACtCG,EAAQC,OAAUvC,EAAlB,QAAmC,MAAOD,KAAKwB,QAC/Ce,EAAQC,OAAUvC,EAAlB,QAAmC,MAAOD,KAAK8B,KAC/CS,EAAQC,OAAUvC,EAAlB,QAAmC,QAASD,KAAKiC,OACjDM,EAAQC,OAAUvC,EAAlB,QAAmC,SAAUD,KAAKqC,2BAzHjCzC,4UCDrB6C,EAAAjF,EAAA,2CAEqBkF,cAEnB,SAAAA,EAAY7C,gGAAMQ,CAAAL,KAAA0C,GAAA,IAAA3C,mKAAA4C,CAAA3C,MAAA0C,EAAAE,WAAAtE,OAAAuE,eAAAH,IAAA3E,KAAAiC,KACVH,EAAO,eADG,OAAAE,EAIlB+C,WAAa,SAACzB,EAAKC,GACjBA,EAAIC,MAAMwB,MAAM,KALAhD,4XAQDwC,8PACfS,CAAAN,EAAAzD,UAAA2D,WAAAtE,OAAAuE,eAAAH,EAAAzD,WAAA,mBAAAe,MAAAjC,KAAAiC,KAAuBuC,GADA,IAEhBtC,EAAYD,KAAZC,SACPsC,EAAQC,OAAUvC,EAAlB,gBAA2C,MAAOD,KAAK8C,+BAbtCJ,iCCHrB,MAAAO,EAAAzF,EAAA,uCAEA+E,QAAQC,OAAO,UAAW,MAAO,SAACnB,EAAKC,GACrCA,EAAIC,MAAO2B,KAAM5E,OAAO4E,KAAKX,UAAYA,QAAQY,UAGnD,IAAAC,EAAAC,QAAexD,OAAOyD,iBAAiBf","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\n\n// we store \"non-public\" data on our resources under `_` property, so remove it for render \n// (or remove it from all entries in an array)\nexport const strip = (data) => {\n  if( data instanceof Array ){\n    return data.map(strip)\n  }else {\n    return _.omit(data, '_')\n  }\n}","import { strip } from './util'\n\nexport default class Base {\n\n  constructor(state, STATE_PROP, resource=`/${STATE_PROP}`){\n    this.STATE_PROP = STATE_PROP\n    this[STATE_PROP] = state[STATE_PROP] = state[STATE_PROP] || []\n    this.resource = resource\n  }\n\n  nextId = 1\n  generatedId = () => nextId++\n\n  col = () => this[this.STATE_PROP]\n\n  getId = obj => obj.id\n  setId = (obj, id) => obj.id = id\n  findById = id => _.find(this.col(), e => this.getId(e) == id)\n  findByIndex = id => _.findIndex(this.col(), (e => this.getId(e) == id ))\n  persist = obj => {\n    var col = this.col()\n    var idx = this.findByIndex( this.getId(obj) )\n    if( idx >= 0 ){\n      col[idx] = obj\n    }else{\n      col.push(obj)\n    }\n  }\n\n  get = (req, res) => {\n    const data = this.col()\n    return res.json( { data })\n  }\n\n  getOne = (req, res) => {\n    const { id } = req.params\n    const match = this.findById(id)\n    if( match ) {\n      return res.json( strip(match) )\n    }else{\n      return res.json(404, {\n        \"errors\": [\n            {\n                \"title\": \"Resource Not Found\",\n                \"detail\": \"ID `\" + id + \"` was not found.\"\n            }\n        ]\n      }); \n    }\n  }\n\n  put = (req, res) => {\n    const { id } = req.params\n    const match = this.findById(id)\n    if( match ) {\n      const updated = req.body\n      this.setId(updated, this.getId(match))\n      this.persist(updated)\n      return res.json( strip(updated) )\n    }else{\n      return res.json(404, {\n        \"errors\": [\n            {\n                \"title\": \"Resource Not Found\",\n                \"detail\": \"ID `\" + id + \"` was not found.\"\n            }\n        ]\n      }); \n    }\n  }\n\n  patch = (req, res) => {\n    const { id } = req.params\n    const match = this.findById(id)\n    if( match ) {\n      const result = _.extend({}, match, req.body)\n      this.setId(result, this.getId(match))\n      this.persist(result)\n      return res.json( strip(result) )\n    }else{\n      return res.json(404, {\n        \"errors\": [\n            {\n                \"title\": \"Resource Not Found\",\n                \"detail\": \"ID `\" + id + \"` was not found.\"\n            }\n        ]\n      }); \n    }\n  }\n\n  post = (req, res) => {\n    const { body } = req\n    body.id = this.generatedId()\n    this.persist(body)\n    return res.json(body)\n  }\n\n  delete = (req, res) => {\n    const { id } = req.params\n    const match = this.findByIndex(id)\n    if( match >= 0 ) {\n      delete this.col()[match]\n      return res.json( {message: 'ok'} )\n    }else{\n      return res.json(404, {\n        \"errors\": [\n            {\n                \"title\": \"Resource Not Found\",\n                \"detail\": `Resource ${this.STATE_PROP}=>${id} was not found.`\n            }\n        ]\n      }); \n    }\n  }\n\n  configureSandbox(Sandbox){        \n    const {resource} = this\n    Sandbox.define(resource, 'get', this.get)\n    Sandbox.define(resource, 'post', this.post)\n    Sandbox.define(`${resource}/{id}`, 'get', this.getOne)\n    Sandbox.define(`${resource}/{id}`, 'put', this.put)\n    Sandbox.define(`${resource}/{id}`, 'patch', this.patch)\n    Sandbox.define(`${resource}/{id}`, 'delete', this.delete)\n  }\n}","\nimport Base from './base'\n\nexport default class Identities extends Base {\n\n  constructor(state){\n    super(state, 'identities')\n  }\n\n  getSponsor = (req, res) => {\n    res.json({test: true})\n  }\n\n  configureSandbox(Sandbox){\n    super.configureSandbox(Sandbox)\n    const {resource} = this\n    Sandbox.define(`${resource}/{id}/sponsor`, 'get', this.getSponsor)\n  }\n\n}","import Identities from './identity'\n\nSandbox.define('/_state', 'get', (req, res) => {\n  res.json( {keys: Object.keys(Sandbox) }, Sandbox.config )\n})\n\nnew Identities(state).configureSandbox(Sandbox)\n"],"sourceRoot":""}